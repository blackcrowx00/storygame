<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blind Story</title>

<style>
body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background:#111;
  color:#fff;
  margin:0;
}
.container {
  max-width:600px;
  margin:auto;
  padding:16px;
}
.card {
  background:#1c1c1c;
  border-radius:12px;
  padding:16px;
  margin-bottom:16px;
}
h1,h2,h3 { text-align:center; }
textarea {
  width:100%;
  height:120px;
  border-radius:8px;
  padding:12px;
  font-size:16px;
}
button {
  width:100%;
  padding:16px;
  margin-top:12px;
  font-size:18px;
  border:none;
  border-radius:10px;
  font-weight:bold;
}
.primary { background:#4caf50; }
.secondary { background:#2196f3; color:#fff; }
.danger { background:#e53935; color:#fff; }
.hidden { display:none; }
.info { font-size:14px; opacity:.85; margin-top:8px; }
.big-pass {
  font-size:28px;
  padding:40px;
  background:#000;
}
.fade-sentence {
  opacity:0;
  animation: fadeIn 1s forwards;
}
@keyframes fadeIn {
  to { opacity:1; }
}
</style>
</head>

<body>
<div class="container">

<h1>Blind Story</h1>

<!-- START -->
<div id="start" class="card">
  <h2>Setup</h2>

  <label>Rounds per player</label>
  <select id="roundSelect">
    <option value="2">2 each (4 turns)</option>
    <option value="3">3 each (6 turns)</option>
    <option value="4">4 each (8 turns)</option>
  </select>

  <label class="info">
    <input type="checkbox" id="usePrompt" checked> Start with a random prompt
  </label>

  <label>Narrator voice</label>
  <select id="voiceSelect"></select>

  <label class="info">
    <input type="checkbox" id="ambientToggle"> Ambient sound
  </label>

  <button class="primary" onclick="startGame()">Start Game</button>
</div>

<!-- PASS PHONE -->
<div id="pass" class="card hidden">
  <h2>Pass the phone</h2>
  <button class="big-pass primary" onclick="continueAfterPass()">HAND OVER PHONE</button>
</div>

<!-- GAME -->
<div id="game" class="card hidden">
  <h2 id="turnTitle"></h2>
  <div id="context" class="info"></div>

  <textarea id="input"></textarea>
  <div class="info" id="counter"></div>

  <button class="primary" onclick="submitTurn()">Submit</button>
  <button class="danger" onclick="resetGame()">Reset</button>
</div>

<!-- END -->
<div id="end" class="card hidden">
  <h2 id="storyTitle"></h2>
  <div id="fullStory"></div>

  <button class="secondary" onclick="readStory()">üîä Read Aloud</button>
  <button class="primary" onclick="resetGame()">üîÅ Play Again</button>
</div>

<audio id="ambient" loop>
  <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_4f0c6a3c7c.mp3">
</audio>

</div>

<script>
const MAX_CHARS = 255, MAX_SENTENCES = 4;
let rounds = 2, TOTAL_TURNS = 4;
let turns = [], currentTurn = 0;
let voices = [];

const prompts = [
  "It was the last night before everything changed.",
  "The message was meant for someone else.",
  "Nobody noticed the door was already open.",
  "This was not how the story was supposed to end."
];

speechSynthesis.onvoiceschanged = () => {
  voices = speechSynthesis.getVoices();
  const sel = document.getElementById("voiceSelect");
  sel.innerHTML = voices.map((v,i)=>`<option value="${i}">${v.name}</option>`).join("");
};

function startGame() {
  rounds = +roundSelect.value;
  TOTAL_TURNS = rounds * 2;
  tu
